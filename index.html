<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestion Pointage Chantier</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding-bottom: 80px;
      }

      .app-container {
        max-width: 480px;
        margin: 0 auto;
        background: #f5f5f7;
        min-height: 100vh;
        position: relative;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        color: white;
        border-radius: 0 0 30px 30px;
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .date-badge {
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .user-info {
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .chantier-select {
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        padding: 12px 16px;
        border-radius: 15px;
        color: white;
        font-size: 16px;
        width: 100%;
        margin-bottom: 15px;
        cursor: pointer;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
      }

      .search-bar {
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        padding: 12px 16px 12px 45px;
        border-radius: 15px;
        color: white;
        font-size: 14px;
        width: 100%;
        position: relative;
      }

      .search-bar::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }

      .search-container {
        position: relative;
      }

      .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.7);
      }

      .refresh-icon {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.7);
        cursor: pointer;
      }

      .stats-cards {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-top: 20px;
      }

      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px 10px;
        border-radius: 20px;
        text-align: center;
        color: white;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .stat-icon {
        font-size: 30px;
        margin-bottom: 10px;
      }

      .stat-label {
        font-size: 12px;
        opacity: 0.9;
        margin-bottom: 5px;
      }

      .stat-value {
        font-size: 32px;
        font-weight: bold;
      }

      .content {
        padding: 20px;
      }

      .employee-card {
        background: white;
        border-radius: 20px;
        padding: 15px;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        position: relative;
      }

      .employee-avatar {
        width: 50px;
        height: 50px;
        border-radius: 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 18px;
        flex-shrink: 0;
      }

      .employee-info {
        flex: 1;
      }

      .employee-name {
        font-weight: 600;
        font-size: 16px;
        margin-bottom: 4px;
        color: #1a1a1a;
      }

      .employee-meta {
        font-size: 13px;
        color: #666;
      }

      .toggle-switch {
        width: 50px;
        height: 28px;
        background: #10b981;
        border-radius: 14px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s;
      }

      .toggle-switch::after {
        content: "";
        position: absolute;
        width: 24px;
        height: 24px;
        background: white;
        border-radius: 50%;
        top: 2px;
        right: 2px;
        transition: transform 0.3s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .toggle-switch.off {
        background: #e5e7eb;
      }

      .toggle-switch.off::after {
        transform: translateX(-22px);
      }

      .footer-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        display: flex;
        justify-content: space-around;
        padding: 12px 0 20px 0;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        border-radius: 30px 30px 0 0;
        max-width: 480px;
        margin: 0 auto;
      }

      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        flex: 1;
        padding: 8px;
        transition: all 0.3s;
      }

      .nav-item.active {
        color: #667eea;
      }

      .nav-item:not(.active) {
        color: #9ca3af;
      }

      .nav-icon {
        font-size: 24px;
      }

      .nav-label {
        font-size: 12px;
      }

      .page {
        display: none;
      }

      .page.active {
        display: block;
      }

      .dashboard-section {
        margin-bottom: 25px;
      }

      .section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: #1a1a1a;
      }

      .kpi-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 20px;
      }

      .kpi-card {
        background: white;
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .kpi-card.full {
        grid-column: 1 / -1;
      }

      .kpi-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .kpi-label {
        font-size: 14px;
        color: #666;
      }

      .kpi-value {
        font-size: 36px;
        font-weight: bold;
        color: #667eea;
      }

      .kpi-trend {
        font-size: 12px;
        color: #10b981;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .chart-container {
        background: white;
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .chart-canvas {
        width: 100%;
        height: 200px;
      }

      .action-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 20px;
      }

      .action-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px;
        border-radius: 15px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .action-button.secondary {
        background: white;
        color: #667eea;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .action-button.full {
        grid-column: 1 / -1;
      }

      .tabs {
        display: flex;
        background: white;
        border-radius: 15px;
        padding: 5px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .tab {
        flex: 1;
        padding: 12px;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
        color: #666;
      }

      .tab.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .filter-bar {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        overflow-x: auto;
        padding-bottom: 5px;
      }

      .filter-chip {
        background: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        white-space: nowrap;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s;
      }

      .filter-chip.active {
        background: #667eea;
        color: white;
      }

      .verification-summary {
        background: white;
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .summary-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 15px;
      }

      .summary-item {
        text-align: center;
        padding: 15px;
        border-radius: 15px;
        background: #f9fafb;
      }

      .summary-value {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .summary-value.success {
        color: #10b981;
      }

      .summary-value.danger {
        color: #ef4444;
      }

      .summary-value.warning {
        color: #f59e0b;
      }

      .summary-label {
        font-size: 12px;
        color: #666;
      }

      .accordion {
        background: white;
        border-radius: 20px;
        margin-bottom: 15px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .accordion-header {
        padding: 15px 20px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        background: #f9fafb;
      }

      .accordion-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s;
      }

      .accordion.open .accordion-content {
        max-height: 2000px;
      }

      .accordion-body {
        padding: 15px;
      }

      .history-card {
        background: white;
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .history-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .history-date {
        font-weight: 600;
        font-size: 16px;
      }

      .period-badge {
        background: #667eea;
        color: white;
        padding: 5px 12px;
        border-radius: 10px;
        font-size: 12px;
      }

      .history-stats {
        display: flex;
        gap: 20px;
        margin-bottom: 10px;
      }

      .history-stat {
        font-size: 14px;
        color: #666;
      }

      .history-stat strong {
        color: #1a1a1a;
      }

      .calendar-container {
        background: white;
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
      }

      .calendar-day {
        aspect-ratio: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        font-size: 14px;
        cursor: pointer;
      }

      .calendar-day.header {
        font-weight: 600;
        color: #666;
      }

      .calendar-day.active {
        background: #667eea;
        color: white;
      }

      .calendar-day.has-data::after {
        content: "";
        width: 4px;
        height: 4px;
        background: #10b981;
        border-radius: 50%;
        position: absolute;
        bottom: 5px;
      }

      .floating-button {
        position: fixed;
        bottom: 100px;
        right: 20px;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        cursor: pointer;
        z-index: 100;
      }

      .submit-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 18px;
        border-radius: 15px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        width: 100%;
        margin-top: 20px;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .period-toggle {
        display: flex;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 15px;
        padding: 5px;
        margin-bottom: 20px;
      }

      .period-option {
        flex: 1;
        padding: 10px;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.7);
        transition: all 0.3s;
      }

      .period-option.active {
        background: white;
        color: #667eea;
      }

      .counter {
        background: rgba(255, 255, 255, 0.15);
        padding: 10px 20px;
        border-radius: 15px;
        text-align: center;
        margin-bottom: 20px;
        color: white;
        font-weight: 600;
      }

      .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: #666;
      }

      .empty-state-icon {
        font-size: 60px;
        margin-bottom: 15px;
        opacity: 0.3;
      }

      .donut-chart {
        width: 200px;
        height: 200px;
        margin: 20px auto;
      }

      .progress-bar {
        height: 8px;
        background: #e5e7eb;
        border-radius: 10px;
        overflow: hidden;
        margin-top: 10px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        transition: width 0.3s;
      }

      .alert {
        background: #fef3c7;
        border-left: 4px solid #f59e0b;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        font-size: 14px;
      }

      .badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 10px;
        font-size: 11px;
        font-weight: 600;
      }

      .badge.success {
        background: #d1fae5;
        color: #065f46;
      }

      .badge.danger {
        background: #fee2e2;
        color: #991b1b;
      }

      .badge.warning {
        background: #fef3c7;
        color: #92400e;
      }

      @media (min-width: 481px) {
        .app-container {
          box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
        }
      }

      .loading {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        z-index: 1000;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        align-items: center;
        justify-content: center;
      }

      .modal.active {
        display: flex;
      }

      .modal-content {
        background: white;
        border-radius: 20px;
        padding: 30px;
        max-width: 90%;
        max-height: 80%;
        overflow-y: auto;
      }

      .modal-header {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 20px;
      }

      .modal-footer {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      .btn {
        padding: 12px 24px;
        border-radius: 10px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        flex: 1;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-secondary {
        background: #e5e7eb;
        color: #1a1a1a;
      }

      .mini-employee {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        border-bottom: 1px solid #f3f4f6;
      }

      .mini-avatar {
        width: 35px;
        height: 35px;
        border-radius: 10px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
      }

      .mini-info {
        flex: 1;
      }

      .mini-name {
        font-weight: 600;
        font-size: 14px;
      }

      .mini-meta {
        font-size: 12px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <div id="accueilPage" class="page active">
        <div class="header">
          <div class="header-top">
            <div class="date-badge">üìÖ <span id="currentDate"></span></div>
            <div class="user-info">Bonjour, support@iway.ma üëã</div>
          </div>
          <select class="chantier-select" id="chantierSelect">
            <option>üèóÔ∏è CHANTIER C1</option>
            <option>üèóÔ∏è CHANTIER C2</option>
            <option>üèóÔ∏è CHANTIER C3</option>
          </select>
          <div class="search-container">
            <span class="search-icon">üîç</span>
            <input
              type="text"
              class="search-bar"
              placeholder="Rechercher (nom, pr√©nom, matricule)..."
            />
            <span class="refresh-icon">üîÑ</span>
          </div>
        </div>

        <div class="content">
          <div class="stats-cards">
            <div class="stat-card">
              <div class="stat-icon">üë•</div>
              <div class="stat-label">Total Employ√©s</div>
              <div class="stat-value">2</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">‚òÄÔ∏è</div>
              <div class="stat-label">Pointage Matin</div>
              <div class="stat-value">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üåô</div>
              <div class="stat-label">Pointage Soir</div>
              <div class="stat-value">19</div>
            </div>
          </div>

          <div class="dashboard-section">
            <div class="section-title">Statistiques du jour</div>
            <div class="kpi-grid">
              <div class="kpi-card full">
                <div class="kpi-header">
                  <span class="kpi-label">Taux de pr√©sence</span>
                  <span class="kpi-trend">‚Üó +5%</span>
                </div>
                <div class="kpi-value">85%</div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 85%"></div>
                </div>
              </div>
              <div class="kpi-card">
                <div class="kpi-label">Pr√©sents</div>
                <div class="kpi-value" style="font-size: 28px; color: #10b981">
                  17
                </div>
              </div>
              <div class="kpi-card">
                <div class="kpi-label">Absents</div>
                <div class="kpi-value" style="font-size: 28px; color: #ef4444">
                  3
                </div>
              </div>
            </div>
          </div>

          <div class="dashboard-section">
            <div class="section-title">Pr√©sence sur 7 jours</div>
            <div class="chart-container">
              <canvas id="weekChart" class="chart-canvas"></canvas>
            </div>
          </div>

          <div class="dashboard-section">
            <div class="section-title">R√©partition du jour</div>
            <div class="chart-container">
              <canvas id="pieChart" class="chart-canvas"></canvas>
            </div>
          </div>

          <div class="action-buttons">
            <button class="action-button full" onclick="goToPointage()">
              ‚úÖ Commencer le pointage
            </button>
            <button class="action-button secondary" onclick="goToHistory()">
              üìä Voir l'historique
            </button>
            <button class="action-button secondary">üìÑ G√©n√©rer rapport</button>
          </div>
        </div>
      </div>

      <div id="pointagePage" class="page">
        <div class="header">
          <div class="header-top">
            <div class="date-badge">üìÖ <span class="date-display"></span></div>
            <div class="user-info">CHANTIER C1</div>
          </div>
          <div class="period-toggle">
            <div class="period-option active" onclick="switchPeriod('matin')">
              ‚òÄÔ∏è Matin
            </div>
            <div class="period-option" onclick="switchPeriod('soir')">
              üåô Soir
            </div>
          </div>
          <div class="counter" id="counter">Point√©s: 0 / 20</div>
        </div>

        <div class="content">
          <div class="tabs">
            <div class="tab active" onclick="switchTab('pointage')">
              Pointage
            </div>
            <div class="tab" onclick="switchTab('verification')">
              V√©rification
            </div>
          </div>

          <div id="pointageTab" class="tab-content">
            <div class="filter-bar">
              <div class="filter-chip active" onclick="filterEmployees('tous')">
                Tous
              </div>
              <div class="filter-chip" onclick="filterEmployees('pointes')">
                Point√©s
              </div>
              <div class="filter-chip" onclick="filterEmployees('non-pointes')">
                Non point√©s
              </div>
              <div class="filter-chip" onclick="filterEmployees('ma√ßon')">
                Ma√ßons
              </div>
              <div class="filter-chip" onclick="filterEmployees('electricien')">
                √âlectriciens
              </div>
            </div>

            <div id="employeeList"></div>

            <button class="submit-button" onclick="validatePointages()">
              ‚úÖ Valider tous les pointages (0)
            </button>
          </div>

          <div id="verificationTab" class="tab-content" style="display: none">
            <div class="verification-summary">
              <div class="section-title">R√©sum√© Global</div>
              <div class="summary-grid">
                <div class="summary-item">
                  <div class="summary-value success" id="presentCount">0</div>
                  <div class="summary-label">‚úì Pr√©sents</div>
                </div>
                <div class="summary-item">
                  <div class="summary-value danger" id="absentCount">0</div>
                  <div class="summary-label">‚úó Absents</div>
                </div>
                <div class="summary-item">
                  <div class="summary-value warning" id="retardCount">0</div>
                  <div class="summary-label">‚ö† Retards</div>
                </div>
                <div class="summary-item">
                  <div class="summary-value" id="nonPointeCount">0</div>
                  <div class="summary-label">Non point√©s</div>
                </div>
              </div>
              <div class="progress-bar" style="margin-top: 20px">
                <div
                  class="progress-fill"
                  id="verificationProgress"
                  style="width: 0%"
                ></div>
              </div>
            </div>

            <div class="accordion" id="presentAccordion">
              <div
                class="accordion-header"
                onclick="toggleAccordion('presentAccordion')"
              >
                <span>‚úì Pr√©sents (<span id="presentListCount">0</span>)</span>
                <span>‚ñº</span>
              </div>
              <div class="accordion-content">
                <div class="accordion-body" id="presentList"></div>
              </div>
            </div>

            <div class="accordion" id="absentAccordion">
              <div
                class="accordion-header"
                onclick="toggleAccordion('absentAccordion')"
              >
                <span>‚úó Absents (<span id="absentListCount">0</span>)</span>
                <span>‚ñº</span>
              </div>
              <div class="accordion-content">
                <div class="accordion-body" id="absentList"></div>
              </div>
            </div>

            <div class="accordion" id="nonPointeAccordion">
              <div
                class="accordion-header"
                onclick="toggleAccordion('nonPointeAccordion')"
              >
                <span
                  >‚ö™ Non point√©s (<span id="nonPointeListCount">0</span>)</span
                >
                <span>‚ñº</span>
              </div>
              <div class="accordion-content">
                <div class="accordion-body" id="nonPointeList"></div>
              </div>
            </div>

            <div class="action-buttons" style="margin-top: 20px">
              <button class="action-button secondary">üì§ Exporter</button>
              <button class="action-button secondary">‚úèÔ∏è Modifier</button>
            </div>

            <button class="submit-button" onclick="submitFinal()">
              üöÄ Soumettre d√©finitivement
            </button>
          </div>
        </div>
      </div>

      <div id="historiquePage" class="page">
        <div class="header">
          <div class="header-top">
            <div class="date-badge">üìÖ Historique</div>
            <div class="user-info">CHANTIER C1</div>
          </div>
        </div>

        <div class="content">
          <div class="calendar-container">
            <div class="calendar-header">
              <button
                onclick="prevMonth()"
                style="
                  background: none;
                  border: none;
                  font-size: 20px;
                  cursor: pointer;
                "
              >
                ‚óÄ
              </button>
              <div style="font-weight: 600" id="calendarMonth">
                D√©cembre 2025
              </div>
              <button
                onclick="nextMonth()"
                style="
                  background: none;
                  border: none;
                  font-size: 20px;
                  cursor: pointer;
                "
              >
                ‚ñ∂
              </button>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
          </div>

          <div class="filter-bar">
            <div class="filter-chip active">Tous</div>
            <div class="filter-chip">7 jours</div>
            <div class="filter-chip">30 jours</div>
            <div class="filter-chip">Matin</div>
            <div class="filter-chip">Soir</div>
          </div>

          <div id="historyList">
            <div class="history-card">
              <div class="history-header">
                <div class="history-date">Lundi 23 D√©cembre 2025</div>
                <div class="period-badge">‚òÄÔ∏è Matin</div>
              </div>
              <div class="history-stats">
                <div class="history-stat">Pr√©sents: <strong>18/20</strong></div>
                <div class="history-stat">Taux: <strong>90%</strong></div>
                <div class="history-stat">Retards: <strong>1</strong></div>
              </div>
              <button
                class="action-button secondary"
                style="width: 100%; margin-top: 10px"
                onclick="viewDetails('2025-12-23-matin')"
              >
                üëÅÔ∏è Voir d√©tails
              </button>
            </div>

            <div class="history-card">
              <div class="history-header">
                <div class="history-date">Lundi 23 D√©cembre 2025</div>
                <div class="period-badge" style="background: #764ba2">
                  üåô Soir
                </div>
              </div>
              <div class="history-stats">
                <div class="history-stat">Pr√©sents: <strong>17/20</strong></div>
                <div class="history-stat">Taux: <strong>85%</strong></div>
                <div class="history-stat">Retards: <strong>0</strong></div>
              </div>
              <button
                class="action-button secondary"
                style="width: 100%; margin-top: 10px"
                onclick="viewDetails('2025-12-23-soir')"
              >
                üëÅÔ∏è Voir d√©tails
              </button>
            </div>

            <div class="history-card">
              <div class="history-header">
                <div class="history-date">Dimanche 22 D√©cembre 2025</div>
                <div class="period-badge">‚òÄÔ∏è Matin</div>
              </div>
              <div class="history-stats">
                <div class="history-stat">Pr√©sents: <strong>19/20</strong></div>
                <div class="history-stat">Taux: <strong>95%</strong></div>
                <div class="history-stat">Retards: <strong>2</strong></div>
              </div>
              <button
                class="action-button secondary"
                style="width: 100%; margin-top: 10px"
                onclick="viewDetails('2025-12-22-matin')"
              >
                üëÅÔ∏è Voir d√©tails
              </button>
            </div>

            <div class="history-card">
              <div class="history-header">
                <div class="history-date">Samedi 21 D√©cembre 2025</div>
                <div class="period-badge">‚òÄÔ∏è Matin</div>
              </div>
              <div class="history-stats">
                <div class="history-stat">Pr√©sents: <strong>16/20</strong></div>
                <div class="history-stat">Taux: <strong>80%</strong></div>
                <div class="history-stat">Retards: <strong>3</strong></div>
              </div>
              <button
                class="action-button secondary"
                style="width: 100%; margin-top: 10px"
                onclick="viewDetails('2025-12-21-matin')"
              >
                üëÅÔ∏è Voir d√©tails
              </button>
            </div>
          </div>

          <div class="chart-container" style="margin-top: 20px">
            <div class="section-title">Tendance sur 30 jours</div>
            <canvas id="trendChart" class="chart-canvas"></canvas>
          </div>
        </div>

        <div class="floating-button" onclick="exportData()">üì§</div>
      </div>

      <div class="footer-nav">
        <div class="nav-item active" onclick="navigateTo('accueil')">
          <div class="nav-icon">üè†</div>
          <div class="nav-label">Accueil</div>
        </div>
        <div class="nav-item" onclick="navigateTo('pointage')">
          <div class="nav-icon">‚è±Ô∏è</div>
          <div class="nav-label">Pointage</div>
        </div>
        <div class="nav-item" onclick="navigateTo('historique')">
          <div class="nav-icon">üïê</div>
          <div class="nav-label">Historique</div>
        </div>
      </div>

      <div class="modal" id="detailModal">
        <div class="modal-content">
          <div class="modal-header">D√©tails du pointage</div>
          <div id="modalBody"></div>
          <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeModal()">
              Fermer
            </button>
            <button class="btn btn-primary">üì• T√©l√©charger</button>
          </div>
        </div>
      </div>

      <div class="loading" id="loading">
        <div class="spinner"></div>
      </div>
    </div>

    <script>
      const employees = [
        {
          id: 1,
          nom: "MAJID",
          prenom: "Faycal",
          matricule: "0005",
          poste: "Ma√ßon",
          avatar: "FM",
          present: null,
        },
        {
          id: 2,
          nom: "MRABET",
          prenom: "Najiba",
          matricule: "0690",
          poste: "Chef d'√©quipe",
          avatar: "NM",
          present: null,
        },
        {
          id: 3,
          nom: "ALAMI",
          prenom: "Hassan",
          matricule: "0012",
          poste: "√âlectricien",
          avatar: "HA",
          present: null,
        },
        {
          id: 4,
          nom: "BENNANI",
          prenom: "Fatima",
          matricule: "0023",
          poste: "Ma√ßon",
          avatar: "FB",
          present: null,
        },
        {
          id: 5,
          nom: "CHERIF",
          prenom: "Mohammed",
          matricule: "0034",
          poste: "Plombier",
          avatar: "MC",
          present: null,
        },
        {
          id: 6,
          nom: "DRISSI",
          prenom: "Amina",
          matricule: "0045",
          poste: "√âlectricien",
          avatar: "AD",
          present: null,
        },
        {
          id: 7,
          nom: "EL IDRISSI",
          prenom: "Youssef",
          matricule: "0056",
          poste: "Ma√ßon",
          avatar: "YE",
          present: null,
        },
        {
          id: 8,
          nom: "FASSI",
          prenom: "Laila",
          matricule: "0067",
          poste: "Chef d'√©quipe",
          avatar: "LF",
          present: null,
        },
        {
          id: 9,
          nom: "GHARBI",
          prenom: "Karim",
          matricule: "0078",
          poste: "Plombier",
          avatar: "KG",
          present: null,
        },
        {
          id: 10,
          nom: "HARRAK",
          prenom: "Salma",
          matricule: "0089",
          poste: "Ma√ßon",
          avatar: "SH",
          present: null,
        },
        {
          id: 11,
          nom: "IRAQI",
          prenom: "Ahmed",
          matricule: "0091",
          poste: "√âlectricien",
          avatar: "AI",
          present: null,
        },
        {
          id: 12,
          nom: "JAOUHARI",
          prenom: "Nadia",
          matricule: "0102",
          poste: "Ma√ßon",
          avatar: "NJ",
          present: null,
        },
        {
          id: 13,
          nom: "KETTANI",
          prenom: "Omar",
          matricule: "0113",
          poste: "Plombier",
          avatar: "OK",
          present: null,
        },
        {
          id: 14,
          nom: "LAMRANI",
          prenom: "Zineb",
          matricule: "0124",
          poste: "Chef d'√©quipe",
          avatar: "ZL",
          present: null,
        },
        {
          id: 15,
          nom: "MANSOURI",
          prenom: "Rachid",
          matricule: "0135",
          poste: "Ma√ßon",
          avatar: "RM",
          present: null,
        },
        {
          id: 16,
          nom: "NACIRI",
          prenom: "Sanae",
          matricule: "0146",
          poste: "√âlectricien",
          avatar: "SN",
          present: null,
        },
        {
          id: 17,
          nom: "OUAZZANI",
          prenom: "Mehdi",
          matricule: "0157",
          poste: "Plombier",
          avatar: "MO",
          present: null,
        },
        {
          id: 18,
          nom: "QADIRI",
          prenom: "Houda",
          matricule: "0168",
          poste: "Ma√ßon",
          avatar: "HQ",
          present: null,
        },
        {
          id: 19,
          nom: "TAZI",
          prenom: "Samir",
          matricule: "0179",
          poste: "√âlectricien",
          avatar: "ST",
          present: null,
        },
        {
          id: 20,
          nom: "ZIANI",
          prenom: "Imane",
          matricule: "0180",
          poste: "Chef d'√©quipe",
          avatar: "IZ",
          present: null,
        },
      ];

      let currentPeriod = "matin";
      let currentFilter = "tous";
      let currentMonth = new Date();

      function init() {
        updateDate();
        renderEmployees();
        updateCounter();
        initCharts();
        renderCalendar();
      }

      function updateDate() {
        const date = new Date();
        const options = { day: "numeric", month: "short", year: "numeric" };
        const dateStr = date.toLocaleDateString("fr-FR", options);
        document.getElementById("currentDate").textContent = dateStr;
        document.querySelectorAll(".date-display").forEach((el) => {
          el.textContent = dateStr;
        });
      }

      function renderEmployees() {
        const list = document.getElementById("employeeList");
        list.innerHTML = "";

        let filtered = employees;
        if (currentFilter === "pointes") {
          filtered = employees.filter((e) => e.present === true);
        } else if (currentFilter === "non-pointes") {
          filtered = employees.filter((e) => e.present === null);
        } else if (currentFilter !== "tous") {
          filtered = employees.filter((e) =>
            e.poste.toLowerCase().includes(currentFilter)
          );
        }

        filtered.forEach((emp) => {
          const card = document.createElement("div");
          card.className = "employee-card";
          card.innerHTML = `
                    <div class="employee-avatar">${emp.avatar}</div>
                    <div class="employee-info">
                        <div class="employee-name">${emp.prenom} ${
            emp.nom
          }</div>
                        <div class="employee-meta">
                            <span class="badge ${
                              emp.present === true
                                ? "success"
                                : emp.present === false
                                ? "danger"
                                : ""
                            }">${emp.poste}</span>
                            ¬∑ ${emp.matricule}
                        </div>
                    </div>
                    <div class="toggle-switch ${
                      emp.present === true ? "" : "off"
                    }" onclick="togglePresence(${emp.id})"></div>
                `;
          list.appendChild(card);
        });

        if (filtered.length === 0) {
          list.innerHTML =
            '<div class="empty-state"><div class="empty-state-icon">üì≠</div><div>Aucun employ√© trouv√©</div></div>';
        }
      }

      function togglePresence(id) {
        const emp = employees.find((e) => e.id === id);
        if (emp.present === true) {
          emp.present = false;
        } else if (emp.present === false) {
          emp.present = null;
        } else {
          emp.present = true;
        }
        renderEmployees();
        updateCounter();
        updateVerification();
      }

      function updateCounter() {
        const pointed = employees.filter((e) => e.present !== null).length;
        const total = employees.length;
        document.getElementById(
          "counter"
        ).textContent = `Point√©s: ${pointed} / ${total}`;

        const btn = document.querySelector(".submit-button");
        if (btn) {
          btn.textContent = `‚úÖ Valider tous les pointages (${pointed})`;
        }
      }

      function filterEmployees(filter) {
        currentFilter = filter;
        document.querySelectorAll(".filter-chip").forEach((chip) => {
          chip.classList.remove("active");
        });
        event.target.classList.add("active");
        renderEmployees();
      }

      function switchPeriod(period) {
        currentPeriod = period;
        document.querySelectorAll(".period-option").forEach((opt) => {
          opt.classList.remove("active");
        });
        event.target.classList.add("active");
      }

      function switchTab(tab) {
        document.querySelectorAll(".tab").forEach((t) => {
          t.classList.remove("active");
        });
        event.target.classList.add("active");

        if (tab === "pointage") {
          document.getElementById("pointageTab").style.display = "block";
          document.getElementById("verificationTab").style.display = "none";
        } else {
          document.getElementById("pointageTab").style.display = "none";
          document.getElementById("verificationTab").style.display = "block";
          updateVerification();
        }
      }

      function updateVerification() {
        const present = employees.filter((e) => e.present === true);
        const absent = employees.filter((e) => e.present === false);
        const nonPointe = employees.filter((e) => e.present === null);
        const retard = Math.floor(Math.random() * 3);

        document.getElementById("presentCount").textContent = present.length;
        document.getElementById("absentCount").textContent = absent.length;
        document.getElementById("retardCount").textContent = retard;
        document.getElementById("nonPointeCount").textContent =
          nonPointe.length;
        document.getElementById("presentListCount").textContent =
          present.length;
        document.getElementById("absentListCount").textContent = absent.length;
        document.getElementById("nonPointeListCount").textContent =
          nonPointe.length;

        const percentage = (present.length / employees.length) * 100;
        document.getElementById("verificationProgress").style.width =
          percentage + "%";

        document.getElementById("presentList").innerHTML = present
          .map(
            (emp) => `
                <div class="mini-employee">
                    <div class="mini-avatar">${emp.avatar}</div>
                    <div class="mini-info">
                        <div class="mini-name">${emp.prenom} ${emp.nom}</div>
                        <div class="mini-meta">${emp.poste} ¬∑ ${emp.matricule}</div>
                    </div>
                    <span class="badge success">Pr√©sent</span>
                </div>
            `
          )
          .join("");

        document.getElementById("absentList").innerHTML = absent
          .map(
            (emp) => `
                <div class="mini-employee">
                    <div class="mini-avatar">${emp.avatar}</div>
                    <div class="mini-info">
                        <div class="mini-name">${emp.prenom} ${emp.nom}</div>
                        <div class="mini-meta">${emp.poste} ¬∑ ${emp.matricule}</div>
                    </div>
                    <span class="badge danger">Absent</span>
                </div>
            `
          )
          .join("");

        document.getElementById("nonPointeList").innerHTML = nonPointe
          .map(
            (emp) => `
                <div class="mini-employee">
                    <div class="mini-avatar">${emp.avatar}</div>
                    <div class="mini-info">
                        <div class="mini-name">${emp.prenom} ${emp.nom}</div>
                        <div class="mini-meta">${emp.poste} ¬∑ ${emp.matricule}</div>
                    </div>
                </div>
            `
          )
          .join("");
      }

      function toggleAccordion(id) {
        const accordion = document.getElementById(id);
        accordion.classList.toggle("open");
      }

      function navigateTo(page) {
        document.querySelectorAll(".page").forEach((p) => {
          p.classList.remove("active");
        });
        document.querySelectorAll(".nav-item").forEach((nav) => {
          nav.classList.remove("active");
        });

        document.getElementById(page + "Page").classList.add("active");
        event.currentTarget.classList.add("active");
      }

      function goToPointage() {
        navigateTo("pointage");
        document.querySelectorAll(".nav-item")[1].classList.add("active");
        document.querySelectorAll(".nav-item")[0].classList.remove("active");
      }

      function goToHistory() {
        navigateTo("historique");
        document.querySelectorAll(".nav-item")[2].classList.add("active");
        document.querySelectorAll(".nav-item")[0].classList.remove("active");
      }

      function validatePointages() {
        const pointed = employees.filter((e) => e.present !== null).length;
        if (pointed === 0) {
          alert("Aucun pointage √† valider");
          return;
        }
        if (confirm(`Valider ${pointed} pointages ?`)) {
          document.getElementById("loading").style.display = "block";
          setTimeout(() => {
            document.getElementById("loading").style.display = "none";
            alert("Pointages valid√©s avec succ√®s ! ‚úÖ");
          }, 1500);
        }
      }

      function submitFinal() {
        const nonPointe = employees.filter((e) => e.present === null).length;
        if (nonPointe > 0) {
          if (
            !confirm(
              `Attention: ${nonPointe} employ√©s ne sont pas point√©s. Continuer ?`
            )
          ) {
            return;
          }
        }
        if (confirm("Soumettre d√©finitivement ce pointage ?")) {
          document.getElementById("loading").style.display = "block";
          setTimeout(() => {
            document.getElementById("loading").style.display = "none";
            alert("Pointage soumis avec succ√®s ! üöÄ");
          }, 1500);
        }
      }

      function renderCalendar() {
        const grid = document.getElementById("calendarGrid");
        grid.innerHTML = "";

        const days = ["Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"];
        days.forEach((day) => {
          const cell = document.createElement("div");
          cell.className = "calendar-day header";
          cell.textContent = day;
          grid.appendChild(cell);
        });

        const firstDay = new Date(
          currentMonth.getFullYear(),
          currentMonth.getMonth(),
          1
        );
        const lastDay = new Date(
          currentMonth.getFullYear(),
          currentMonth.getMonth() + 1,
          0
        );
        const startDay = firstDay.getDay();

        for (let i = 0; i < startDay; i++) {
          const cell = document.createElement("div");
          cell.className = "calendar-day";
          grid.appendChild(cell);
        }

        for (let day = 1; day <= lastDay.getDate(); day++) {
          const cell = document.createElement("div");
          cell.className = "calendar-day";
          cell.textContent = day;

          const today = new Date();
          if (
            day === today.getDate() &&
            currentMonth.getMonth() === today.getMonth()
          ) {
            cell.classList.add("active");
          }

          if (day < today.getDate()) {
            cell.classList.add("has-data");
          }

          grid.appendChild(cell);
        }

        const monthNames = [
          "Janvier",
          "F√©vrier",
          "Mars",
          "Avril",
          "Mai",
          "Juin",
          "Juillet",
          "Ao√ªt",
          "Septembre",
          "Octobre",
          "Novembre",
          "D√©cembre",
        ];
        document.getElementById("calendarMonth").textContent =
          monthNames[currentMonth.getMonth()] +
          " " +
          currentMonth.getFullYear();
      }

      function prevMonth() {
        currentMonth.setMonth(currentMonth.getMonth() - 1);
        renderCalendar();
      }

      function nextMonth() {
        currentMonth.setMonth(currentMonth.getMonth() + 1);
        renderCalendar();
      }

      function viewDetails(id) {
        document.getElementById("modalBody").innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>P√©riode:</strong> ${
                      id.includes("matin") ? "Matin ‚òÄÔ∏è" : "Soir üåô"
                    }
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Pr√©sents:</strong> 18 / 20 (90%)
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Chef de chantier:</strong> support@iway.ma
                </div>
                <div style="margin-top: 20px;">
                    ${employees
                      .slice(0, 18)
                      .map(
                        (emp) => `
                        <div class="mini-employee">
                            <div class="mini-avatar">${emp.avatar}</div>
                            <div class="mini-info">
                                <div class="mini-name">${emp.prenom} ${emp.nom}</div>
                                <div class="mini-meta">${emp.poste} ¬∑ ${emp.matricule}</div>
                            </div>
                            <span class="badge success">08:15</span>
                        </div>
                    `
                      )
                      .join("")}
                </div>
            `;
        document.getElementById("detailModal").classList.add("active");
      }

      function closeModal() {
        document.getElementById("detailModal").classList.remove("active");
      }

      function exportData() {
        alert("Export des donn√©es en cours... üì§");
      }

      function initCharts() {
        const weekCanvas = document.getElementById("weekChart");
        const pieCanvas = document.getElementById("pieChart");
        const trendCanvas = document.getElementById("trendChart");

        if (weekCanvas) {
          const ctx = weekCanvas.getContext("2d");
          drawBarChart(ctx, weekCanvas.width, weekCanvas.height);
        }

        if (pieCanvas) {
          const ctx = pieCanvas.getContext("2d");
          drawPieChart(ctx, pieCanvas.width, pieCanvas.height);
        }

        if (trendCanvas) {
          const ctx = trendCanvas.getContext("2d");
          drawLineChart(ctx, trendCanvas.width, trendCanvas.height);
        }
      }

      function drawBarChart(ctx, width, height) {
        const data = [85, 90, 88, 92, 87, 85, 90];
        const labels = ["Lun", "Mar", "Mer", "Jeu", "Ven", "Sam", "Dim"];
        const max = 100;
        const padding = 40;
        const barWidth = (width - padding * 2) / data.length - 10;

        ctx.clearRect(0, 0, width, height);
        ctx.fillStyle = "#666";
        ctx.font = "12px sans-serif";

        data.forEach((value, i) => {
          const barHeight = (value / max) * (height - padding * 2);
          const x = padding + i * (barWidth + 10);
          const y = height - padding - barHeight;

          const gradient = ctx.createLinearGradient(0, y, 0, height - padding);
          gradient.addColorStop(0, "#667eea");
          gradient.addColorStop(1, "#764ba2");

          ctx.fillStyle = gradient;
          ctx.fillRect(x, y, barWidth, barHeight);

          ctx.fillStyle = "#666";
          ctx.textAlign = "center";
          ctx.fillText(labels[i], x + barWidth / 2, height - 20);
          ctx.fillText(value + "%", x + barWidth / 2, y - 5);
        });
      }

      function drawPieChart(ctx, width, height) {
        const data = [
          { label: "Pr√©sents", value: 17, color: "#10B981" },
          { label: "Absents", value: 3, color: "#EF4444" },
          { label: "Retards", value: 2, color: "#F59E0B" },
        ];

        const total = data.reduce((sum, item) => sum + item.value, 0);
        const centerX = width / 2;
        const centerY = height / 2;
        const radius = Math.min(width, height) / 2 - 40;

        let currentAngle = -Math.PI / 2;

        ctx.clearRect(0, 0, width, height);

        data.forEach((item) => {
          const sliceAngle = (item.value / total) * 2 * Math.PI;

          ctx.beginPath();
          ctx.arc(
            centerX,
            centerY,
            radius,
            currentAngle,
            currentAngle + sliceAngle
          );
          ctx.lineTo(centerX, centerY);
          ctx.fillStyle = item.color;
          ctx.fill();

          const labelAngle = currentAngle + sliceAngle / 2;
          const labelX = centerX + Math.cos(labelAngle) * (radius + 25);
          const labelY = centerY + Math.sin(labelAngle) * (radius + 25);

          ctx.fillStyle = "#666";
          ctx.font = "12px sans-serif";
          ctx.textAlign = "center";
          ctx.fillText(item.value, labelX, labelY);

          currentAngle += sliceAngle;
        });
      }

      function drawLineChart(ctx, width, height) {
        const data = [
          75, 80, 85, 82, 88, 90, 87, 92, 89, 91, 88, 90, 85, 87, 89, 92, 88,
          86, 90, 93, 89, 91, 87, 88, 90, 92, 89, 87, 85, 90,
        ];
        const padding = 40;
        const max = 100;

        ctx.clearRect(0, 0, width, height);

        ctx.beginPath();
        ctx.strokeStyle = "#667eea";
        ctx.lineWidth = 3;

        data.forEach((value, i) => {
          const x = padding + (i / (data.length - 1)) * (width - padding * 2);
          const y = height - padding - (value / max) * (height - padding * 2);

          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        });

        ctx.stroke();

        ctx.fillStyle = "rgba(102, 126, 234, 0.1)";
        ctx.lineTo(width - padding, height - padding);
        ctx.lineTo(padding, height - padding);
        ctx.closePath();
        ctx.fill();
      }

      window.addEventListener("load", init);
    </script>
  </body>
</html>
