<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pointage Chantier Pro</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        padding-bottom: 100px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .page {
        display: none;
      }

      .page.active {
        display: block;
      }

      .header {
        background: white;
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        color: #2c3e50;
        font-size: 28px;
        margin-bottom: 10px;
      }

      .header-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
      }

      .date-info {
        color: #7f8c8d;
        font-size: 16px;
      }

      .search-filter {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .search-box {
        padding: 12px 20px;
        border: 2px solid #e0e0e0;
        border-radius: 25px;
        font-size: 16px;
        width: 250px;
        transition: all 0.3s;
      }

      .search-box:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
      }

      .filter-btn {
        padding: 12px 25px;
        border: none;
        border-radius: 25px;
        background: #3498db;
        color: white;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 600;
      }

      .filter-btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }

      .stats {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .stat-card {
        background: white;
        padding: 15px 25px;
        border-radius: 12px;
        flex: 1;
        min-width: 150px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .stat-label {
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 5px;
      }

      .stat-value {
        color: #2c3e50;
        font-size: 28px;
        font-weight: bold;
      }

      .employees-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .employee-card {
        background: white;
        border-radius: 15px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        position: relative;
        user-select: none;
      }

      .employee-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .employee-card.selected {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: white;
        box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
      }

      .employee-card.selected .employee-name,
      .employee-card.selected .employee-matricule,
      .employee-card.selected .employee-status {
        color: white;
      }

      .check-icon {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 40px;
        height: 40px;
        background: #27ae60;
        border-radius: 50%;
        display: none;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
      }

      .employee-card.selected .check-icon {
        display: flex;
      }

      .employee-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 12px;
      }

      .employee-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
      }

      .employee-card.selected .employee-avatar {
        background: white;
        color: #3498db;
      }

      .employee-info {
        flex: 1;
      }

      .employee-name {
        font-size: 18px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
      }

      .employee-matricule {
        font-size: 14px;
        color: #7f8c8d;
      }

      .employee-status {
        display: inline-block;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        margin-top: 10px;
      }

      .status-non-pointe {
        background: #ecf0f1;
        color: #7f8c8d;
      }

      .status-matin {
        background: #fff3cd;
        color: #856404;
      }

      .status-soir {
        background: #d1ecf1;
        color: #0c5460;
      }

      .status-complet {
        background: #d4edda;
        color: #155724;
      }

      .employee-card.selected .employee-status {
        background: rgba(255, 255, 255, 0.3);
        color: white;
      }

      .action-bar {
        position: fixed;
        bottom: 80px;
        left: 0;
        right: 0;
        background: white;
        padding: 20px;
        box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.15);
        transform: translateY(100%);
        transition: transform 0.3s;
        z-index: 999;
      }

      .action-bar.visible {
        transform: translateY(0);
      }

      .action-bar-content {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        gap: 15px;
        align-items: stretch;
        flex-wrap: wrap;
      }

      .selection-count {
        font-size: 18px;
        color: #2c3e50;
        font-weight: 700;
        flex: 1;
        display: flex;
        align-items: center;
        min-width: 200px;
      }

      .action-btn {
        padding: 20px 40px;
        border: none;
        border-radius: 15px;
        font-size: 18px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
        flex: 1;
        min-width: 200px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .action-btn:active {
        transform: translateY(0);
      }

      .btn-matin {
        background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        color: white;
      }

      .btn-soir {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: white;
      }

      /* Historique Styles */
      .history-filters {
        background: white;
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .filter-row {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        margin-bottom: 15px;
      }

      .filter-group {
        flex: 1;
        min-width: 200px;
      }

      .filter-group label {
        display: block;
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .filter-group select,
      .filter-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s;
      }

      .filter-group select:focus,
      .filter-group input:focus {
        outline: none;
        border-color: #3498db;
      }

      .history-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .history-item {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
      }

      .history-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      }

      .history-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .history-date {
        font-size: 18px;
        font-weight: bold;
        color: #2c3e50;
      }

      .history-stats {
        display: flex;
        gap: 20px;
      }

      .history-stat {
        text-align: center;
      }

      .history-stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #3498db;
      }

      .history-stat-label {
        font-size: 12px;
        color: #7f8c8d;
      }

      .history-details {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
      }

      .history-detail-item {
        padding: 10px;
        background: #f8f9fa;
        border-radius: 8px;
        font-size: 14px;
      }

      /* Scanner QR Styles */
      .scanner-container {
        background: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .scanner-video {
        width: 100%;
        max-width: 500px;
        height: 400px;
        background: #ecf0f1;
        border-radius: 15px;
        margin: 20px auto;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 60px;
        position: relative;
        overflow: hidden;
      }

      .scanner-overlay {
        position: absolute;
        width: 250px;
        height: 250px;
        border: 3px solid #3498db;
        border-radius: 15px;
        box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
      }

      .scanner-corners {
        position: absolute;
        width: 100%;
        height: 100%;
      }

      .scanner-corner {
        position: absolute;
        width: 30px;
        height: 30px;
        border: 4px solid #3498db;
      }

      .scanner-corner.top-left {
        top: -2px;
        left: -2px;
        border-right: none;
        border-bottom: none;
      }

      .scanner-corner.top-right {
        top: -2px;
        right: -2px;
        border-left: none;
        border-bottom: none;
      }

      .scanner-corner.bottom-left {
        bottom: -2px;
        left: -2px;
        border-right: none;
        border-top: none;
      }

      .scanner-corner.bottom-right {
        bottom: -2px;
        right: -2px;
        border-left: none;
        border-top: none;
      }

      .scanner-line {
        position: absolute;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, transparent, #3498db, transparent);
        animation: scan 2s infinite;
      }

      @keyframes scan {
        0%,
        100% {
          top: 0;
        }
        50% {
          top: calc(100% - 3px);
        }
      }

      .scanner-info {
        margin-top: 20px;
        color: #7f8c8d;
        font-size: 16px;
      }

      .manual-entry {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 15px;
        margin-top: 20px;
      }

      .manual-entry h3 {
        color: #2c3e50;
        margin-bottom: 20px;
        font-size: 20px;
      }

      .input-group {
        margin-bottom: 20px;
      }

      .input-group input {
        width: 100%;
        padding: 15px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 16px;
      }

      .input-group input:focus {
        outline: none;
        border-color: #3498db;
      }

      /* Chantiers Styles */
      .chantiers-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .chantier-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        cursor: pointer;
      }

      .chantier-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .chantier-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
      }

      .chantier-title {
        font-size: 20px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
      }

      .chantier-status {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-actif {
        background: #d4edda;
        color: #155724;
      }

      .status-pause {
        background: #fff3cd;
        color: #856404;
      }

      .status-termine {
        background: #d1ecf1;
        color: #0c5460;
      }

      .chantier-info {
        color: #7f8c8d;
        font-size: 14px;
        margin-bottom: 15px;
      }

      .chantier-info-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
      }

      .chantier-progress {
        margin-top: 15px;
      }

      .progress-label {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: #7f8c8d;
        margin-bottom: 8px;
      }

      .progress-bar-container {
        width: 100%;
        height: 8px;
        background: #ecf0f1;
        border-radius: 10px;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #3498db, #2980b9);
        border-radius: 10px;
        transition: width 0.3s;
      }

      .chantier-team {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #ecf0f1;
      }

      .team-avatars {
        display: flex;
        margin-left: auto;
      }

      .team-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        font-weight: bold;
        margin-left: -10px;
        border: 2px solid white;
      }

      /* Plus Menu Styles */
      .menu-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
      }

      .menu-card {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
      }

      .menu-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .menu-icon {
        font-size: 50px;
        margin-bottom: 15px;
      }

      .menu-title {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .menu-description {
        font-size: 14px;
        color: #7f8c8d;
      }

      .menu-card:hover .menu-description {
        color: rgba(255, 255, 255, 0.9);
      }

      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 2000;
      }

      .modal-overlay.visible {
        display: flex;
      }

      .modal {
        background: white;
        border-radius: 20px;
        padding: 40px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        animation: modalSlideIn 0.3s;
      }

      @keyframes modalSlideIn {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        font-size: 24px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 20px;
        text-align: center;
      }

      .modal-content {
        margin-bottom: 30px;
      }

      .modal-info {
        background: #ecf0f1;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
      }

      .modal-info-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 16px;
      }

      .modal-info-label {
        color: #7f8c8d;
      }

      .modal-info-value {
        color: #2c3e50;
        font-weight: 600;
      }

      .modal-warning {
        background: #fff3cd;
        border-left: 4px solid #f39c12;
        padding: 15px;
        border-radius: 8px;
        color: #856404;
        font-size: 14px;
      }

      .modal-actions {
        display: flex;
        gap: 15px;
      }

      .modal-btn {
        flex: 1;
        padding: 15px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      .modal-btn-cancel {
        background: #ecf0f1;
        color: #2c3e50;
      }

      .modal-btn-cancel:hover {
        background: #bdc3c7;
      }

      .modal-btn-confirm {
        background: #27ae60;
        color: white;
      }

      .modal-btn-confirm:hover {
        background: #229954;
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #27ae60;
        color: white;
        padding: 20px 30px;
        border-radius: 12px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        transform: translateX(400px);
        transition: transform 0.3s;
        z-index: 3000;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .toast.visible {
        transform: translateX(0);
      }

      .toast-icon {
        font-size: 24px;
      }

      .toast-message {
        font-size: 16px;
        font-weight: 600;
      }

      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #2c3e50;
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 12px 20px;
        box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.3);
        z-index: 1000;
      }

      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        transition: all 0.3s;
        padding: 8px 15px;
        border-radius: 12px;
        flex: 1;
        max-width: 120px;
        position: relative;
      }

      .nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-3px);
      }

      .nav-item.active {
        background: rgba(52, 152, 219, 0.3);
      }

      .nav-item.active .nav-icon {
        color: #3498db;
        transform: scale(1.2);
      }

      .nav-icon {
        font-size: 28px;
        transition: all 0.3s;
      }

      .nav-label {
        font-size: 12px;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.8);
        transition: all 0.3s;
      }

      .nav-item.active .nav-label {
        color: #3498db;
      }

      .nav-badge {
        position: absolute;
        top: 5px;
        right: 15px;
        background: #e74c3c;
        color: white;
        font-size: 10px;
        font-weight: bold;
        padding: 3px 6px;
        border-radius: 10px;
        min-width: 18px;
        text-align: center;
      }

      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: white;
      }

      .empty-state-icon {
        font-size: 80px;
        margin-bottom: 20px;
      }

      .empty-state-text {
        font-size: 20px;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        body {
          padding: 15px;
          padding-bottom: 100px;
        }

        .employees-list,
        .chantiers-grid,
        .menu-grid {
          grid-template-columns: 1fr;
        }

        .action-bar-content {
          flex-direction: column;
        }

        .selection-count {
          width: 100%;
          text-align: center;
          margin-bottom: 10px;
          justify-content: center;
        }

        .action-btn {
          width: 100%;
        }

        .nav-icon {
          font-size: 24px;
        }

        .nav-label {
          font-size: 11px;
        }

        .bottom-nav {
          padding: 10px 5px;
        }

        .nav-item {
          padding: 6px 8px;
          max-width: 100px;
        }

        .history-stats {
          gap: 10px;
        }

        .filter-row {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- PAGE POINTAGE -->
      <div id="pointage-page" class="page active">
        <div class="header">
          <h1>üìã Pointage Chantier</h1>
          <div class="header-info">
            <div class="date-info" id="currentDate"></div>
            <div class="search-filter">
              <input
                type="text"
                class="search-box"
                id="searchBox"
                placeholder="üîç Rechercher un employ√©..."
              />
              <button class="filter-btn" onclick="toggleFilter()">
                üîß Filtres
              </button>
            </div>
          </div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-label">Total Employ√©s</div>
            <div class="stat-value" id="totalEmployees">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">S√©lectionn√©s</div>
            <div class="stat-value" id="selectedCount">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Point√©s Matin</div>
            <div class="stat-value" id="matinCount">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Point√©s Soir</div>
            <div class="stat-value" id="soirCount">0</div>
          </div>
        </div>

        <div class="employees-list" id="employeesList"></div>
      </div>

      <!-- PAGE HISTORIQUE -->
      <div id="historique-page" class="page">
        <div class="header">
          <h1>üìä Historique des Pointages</h1>
          <div class="date-info" id="historiqueDate"></div>
        </div>

        <div class="history-filters">
          <div class="filter-row">
            <div class="filter-group">
              <label>Date de d√©but</label>
              <input type="date" id="dateDebut" />
            </div>
            <div class="filter-group">
              <label>Date de fin</label>
              <input type="date" id="dateFin" />
            </div>
            <div class="filter-group">
              <label>Chantier</label>
              <select id="chantierFilter">
                <option value="">Tous les chantiers</option>
                <option value="1">R√©sidence Atlas</option>
                <option value="2">Centre Commercial Anfa</option>
                <option value="3">Tour Marina</option>
              </select>
            </div>
            <div class="filter-group">
              <label>Employ√©</label>
              <input
                type="text"
                placeholder="Rechercher..."
                id="employeFilter"
              />
            </div>
          </div>
          <button class="filter-btn" onclick="applyHistoryFilters()">
            Appliquer les filtres
          </button>
        </div>

        <div class="history-list" id="historyList"></div>
      </div>

      <!-- PAGE SCANNER QR -->
      <div id="scan-page" class="page">
        <div class="header">
          <h1>üì± Scanner QR Code</h1>
          <div class="date-info">Pointage rapide par QR Code</div>
        </div>

        <div class="scanner-container">
          <h2 style="color: #2c3e50; margin-bottom: 20px">
            Scannez le badge de l'employ√©
          </h2>
          <div class="scanner-video">
            üì∑
            <div class="scanner-overlay">
              <div class="scanner-corners">
                <div class="scanner-corner top-left"></div>
                <div class="scanner-corner top-right"></div>
                <div class="scanner-corner bottom-left"></div>
                <div class="scanner-corner bottom-right"></div>
              </div>
              <div class="scanner-line"></div>
            </div>
          </div>
          <div class="scanner-info">
            Positionnez le QR code dans le cadre pour scanner automatiquement
          </div>
          <button
            class="filter-btn"
            onclick="startScanner()"
            style="margin-top: 20px"
          >
            üé• Activer la cam√©ra
          </button>

          <div class="manual-entry">
            <h3>Saisie manuelle</h3>
            <div class="input-group">
              <input
                type="text"
                id="manualMatricule"
                placeholder="Entrez le matricule (ex: EMP001)"
              />
            </div>
            <button class="filter-btn" onclick="validateManualEntry()">
              Valider le pointage
            </button>
          </div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-label">Pointages aujourd'hui</div>
            <div class="stat-value">24</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Dernier pointage</div>
            <div class="stat-value" style="font-size: 16px">
              Ahmed B. - 14:32
            </div>
          </div>
        </div>
      </div>

      <!-- PAGE CHANTIERS -->
      <div id="chantiers-page" class="page">
        <div class="header">
          <h1>üèóÔ∏è Gestion des Chantiers</h1>
          <div class="header-info">
            <div class="date-info">Chantiers actifs et en cours</div>
            <button class="filter-btn" onclick="addChantier()">
              ‚ûï Nouveau chantier
            </button>
          </div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-label">Chantiers Actifs</div>
            <div class="stat-value">3</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">En Pause</div>
            <div class="stat-value">1</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Termin√©s ce mois</div>
            <div class="stat-value">2</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Total Employ√©s</div>
            <div class="stat-value">45</div>
          </div>
        </div>

        <div class="chantiers-grid" id="chantiersList"></div>
      </div>

      <!-- PAGE PLUS -->
      <div id="plus-page" class="page">
        <div class="header">
          <h1>‚ãØ Plus d'options</h1>
          <div class="date-info">Param√®tres et fonctionnalit√©s avanc√©es</div>
        </div>

        <div class="menu-grid" id="plusMenu"></div>
      </div>
    </div>

    <div class="action-bar" id="actionBar">
      <div class="action-bar-content">
        <div class="selection-count" id="selectionText">
          0 employ√©(s) s√©lectionn√©(s)
        </div>
        <button
          class="action-btn btn-matin"
          onclick="validatePointage('matin')"
        >
          ‚òÄÔ∏è Pointer Matin (0.5j)
        </button>
        <button class="action-btn btn-soir" onclick="validatePointage('soir')">
          üåô Pointer Soir (0.5j)
        </button>
      </div>
    </div>

    <div class="modal-overlay" id="modalOverlay">
      <div class="modal">
        <div class="modal-header">‚ö†Ô∏è Confirmation de pointage</div>
        <div class="modal-content">
          <div class="modal-info">
            <div class="modal-info-row">
              <span class="modal-info-label">Employ√©s s√©lectionn√©s:</span>
              <span class="modal-info-value" id="modalEmployeeCount">0</span>
            </div>
            <div class="modal-info-row">
              <span class="modal-info-label">Type de pointage:</span>
              <span class="modal-info-value" id="modalPointageType">-</span>
            </div>
            <div class="modal-info-row">
              <span class="modal-info-label">Date:</span>
              <span class="modal-info-value" id="modalDate">-</span>
            </div>
          </div>
          <div class="modal-warning">
            ‚ö†Ô∏è Cette action appliquera le pointage √† tous les employ√©s
            s√©lectionn√©s. Cette action est d√©finitive.
          </div>
        </div>
        <div class="modal-actions">
          <button class="modal-btn modal-btn-cancel" onclick="closeModal()">
            Annuler
          </button>
          <button
            class="modal-btn modal-btn-confirm"
            onclick="confirmPointage()"
          >
            Confirmer
          </button>
        </div>
      </div>
    </div>

    <div class="toast" id="toast">
      <div class="toast-icon">‚úì</div>
      <div class="toast-message" id="toastMessage"></div>
    </div>

    <nav class="bottom-nav">
      <div class="nav-item active" onclick="navigateTo('pointage')">
        <div class="nav-icon">‚úì</div>
        <div class="nav-label">Pointage</div>
      </div>
      <div class="nav-item" onclick="navigateTo('historique')">
        <div class="nav-icon">üìä</div>
        <div class="nav-label">Historique</div>
        <div class="nav-badge" id="historyBadge">12</div>
      </div>
      <div class="nav-item" onclick="navigateTo('scan')">
        <div class="nav-icon">üì±</div>
        <div class="nav-label">Scanner QR</div>
      </div>
      <div class="nav-item" onclick="navigateTo('chantiers')">
        <div class="nav-icon">üèóÔ∏è</div>
        <div class="nav-label">Chantiers</div>
      </div>
      <div class="nav-item" onclick="navigateTo('plus')">
        <div class="nav-icon">‚ãØ</div>
        <div class="nav-label">Plus</div>
      </div>
    </nav>

    <script>
      // DATA
      const employees = [
        {
          id: 1,
          name: "Ahmed Benjelloun",
          matricule: "EMP001",
          status: "non-pointe",
        },
        {
          id: 2,
          name: "Fatima Alaoui",
          matricule: "EMP002",
          status: "non-pointe",
        },
        {
          id: 3,
          name: "Mohammed El Fassi",
          matricule: "EMP003",
          status: "non-pointe",
        },
        {
          id: 4,
          name: "Zineb Tazi",
          matricule: "EMP004",
          status: "non-pointe",
        },
        {
          id: 5,
          name: "Youssef Benali",
          matricule: "EMP005",
          status: "non-pointe",
        },
        {
          id: 6,
          name: "Samira Idrissi",
          matricule: "EMP006",
          status: "non-pointe",
        },
        {
          id: 7,
          name: "Karim Kettani",
          matricule: "EMP007",
          status: "non-pointe",
        },
        {
          id: 8,
          name: "Nadia Chraibi",
          matricule: "EMP008",
          status: "non-pointe",
        },
        {
          id: 9,
          name: "Omar Squalli",
          matricule: "EMP009",
          status: "non-pointe",
        },
        {
          id: 10,
          name: "Leila Berrada",
          matricule: "EMP010",
          status: "non-pointe",
        },
        {
          id: 11,
          name: "Hassan Filali",
          matricule: "EMP011",
          status: "non-pointe",
        },
        {
          id: 12,
          name: "Amina Mahjoub",
          matricule: "EMP012",
          status: "non-pointe",
        },
      ];

      const historyData = [
        {
          date: "2024-12-18",
          totalEmployes: 12,
          matin: 10,
          soir: 11,
          absents: 1,
          chantier: "R√©sidence Atlas",
        },
        {
          date: "2024-12-17",
          totalEmployes: 12,
          matin: 12,
          soir: 12,
          absents: 0,
          chantier: "R√©sidence Atlas",
        },
        {
          date: "2024-12-16",
          totalEmployes: 12,
          matin: 11,
          soir: 10,
          absents: 1,
          chantier: "R√©sidence Atlas",
        },
      ];

      const chantiers = [
        {
          id: 1,
          nom: "R√©sidence Atlas",
          status: "actif",
          adresse: "Casablanca, Ain Diab",
          dateDebut: "2024-01-15",
          progression: 65,
          employes: 12,
          responsable: "Mohammed K.",
        },
        {
          id: 2,
          nom: "Centre Commercial Anfa",
          status: "actif",
          adresse: "Casablanca, Anfa",
          dateDebut: "2024-03-01",
          progression: 42,
          employes: 18,
          responsable: "Fatima A.",
        },
        {
          id: 3,
          nom: "Tour Marina",
          status: "actif",
          adresse: "Casablanca, Marina",
          dateDebut: "2024-05-20",
          progression: 28,
          employes: 15,
          responsable: "Ahmed B.",
        },
        {
          id: 4,
          nom: "Villa Prestigia",
          status: "pause",
          adresse: "Rabat, Souissi",
          dateDebut: "2024-02-10",
          progression: 85,
          employes: 8,
          responsable: "Zineb T.",
        },
      ];

      const plusMenuItems = [
        {
          icon: "üë•",
          title: "Gestion √âquipes",
          description: "Cr√©er et g√©rer les √©quipes de travail",
          action: "equipes",
        },
        {
          icon: "üìÑ",
          title: "Rapports",
          description: "G√©n√©rer des rapports d√©taill√©s",
          action: "rapports",
        },
        {
          icon: "üìÖ",
          title: "Planning",
          description: "Planifier les horaires de travail",
          action: "planning",
        },
        {
          icon: "üí∞",
          title: "Paie",
          description: "Calculer et g√©rer la paie",
          action: "paie",
        },
        {
          icon: "üë§",
          title: "Profil",
          description: "G√©rer votre profil utilisateur",
          action: "profil",
        },
        {
          icon: "‚öôÔ∏è",
          title: "Param√®tres",
          description: "Configuration de l'application",
          action: "parametres",
        },
        {
          icon: "üì±",
          title: "Notifications",
          description: "G√©rer les notifications push",
          action: "notifications",
        },
        {
          icon: "üìä",
          title: "Statistiques",
          description: "Tableaux de bord et analyses",
          action: "statistiques",
        },
        {
          icon: "üìû",
          title: "Support",
          description: "Contacter l'assistance",
          action: "support",
        },
      ];

      let selectedEmployees = [];
      let currentPointageType = null;
      let lastTap = {};
      let currentPage = "pointage";

      // INITIALIZATION
      function init() {
        updateDate();
        renderEmployees();
        updateStats();
        setupSearch();
        renderHistory();
        renderChantiers();
        renderPlusMenu();
        setTodayDates();
      }

      function setTodayDates() {
        const today = new Date().toISOString().split("T")[0];
        const dateDebut = document.getElementById("dateDebut");
        const dateFin = document.getElementById("dateFin");
        if (dateDebut) dateDebut.value = today;
        if (dateFin) dateFin.value = today;
      }

      function updateDate() {
        const now = new Date();
        const options = {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        };
        const dateStr = now.toLocaleDateString("fr-FR", options);

        const currentDateEl = document.getElementById("currentDate");
        const histDateEl = document.getElementById("historiqueDate");

        if (currentDateEl) currentDateEl.textContent = dateStr;
        if (histDateEl) histDateEl.textContent = dateStr;

        const modalDateEl = document.getElementById("modalDate");
        if (modalDateEl)
          modalDateEl.textContent = now.toLocaleDateString("fr-FR");
      }

      // NAVIGATION
      function navigateTo(page) {
        currentPage = page;

        document
          .querySelectorAll(".page")
          .forEach((p) => p.classList.remove("active"));
        document
          .querySelectorAll(".nav-item")
          .forEach((item) => item.classList.remove("active"));

        const pageEl = document.getElementById(`${page}-page`);
        if (pageEl) pageEl.classList.add("active");

        event.target.closest(".nav-item").classList.add("active");

        // Hide action bar on non-pointage pages
        if (page !== "pointage") {
          document.getElementById("actionBar").classList.remove("visible");
        } else {
          updateActionBar();
        }
      }

      // POINTAGE PAGE FUNCTIONS
      function getInitials(name) {
        return name
          .split(" ")
          .map((n) => n[0])
          .join("")
          .toUpperCase();
      }

      function getStatusText(status) {
        const statusMap = {
          "non-pointe": "Non point√©",
          matin: "Matin point√©",
          soir: "Soir point√©",
          complet: "Journ√©e compl√®te",
        };
        return statusMap[status] || status;
      }

      function renderEmployees(filter = "") {
        const list = document.getElementById("employeesList");
        if (!list) return;

        const filteredEmployees = employees.filter(
          (emp) =>
            emp.name.toLowerCase().includes(filter.toLowerCase()) ||
            emp.matricule.toLowerCase().includes(filter.toLowerCase())
        );

        if (filteredEmployees.length === 0) {
          list.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üîç</div>
              <div class="empty-state-text">Aucun employ√© trouv√©</div>
            </div>
          `;
          return;
        }

        list.innerHTML = filteredEmployees
          .map(
            (emp) => `
            <div class="employee-card ${
              selectedEmployees.includes(emp.id) ? "selected" : ""
            }" 
                 data-id="${emp.id}"
                 onclick="handleCardClick(${emp.id})">
              <div class="check-icon">‚úì</div>
              <div class="employee-header">
                <div class="employee-avatar">${getInitials(emp.name)}</div>
                <div class="employee-info">
                  <div class="employee-name">${emp.name}</div>
                  <div class="employee-matricule">${emp.matricule}</div>
                </div>
              </div>
              <div class="employee-status status-${emp.status}">
                ${getStatusText(emp.status)}
              </div>
            </div>
          `
          )
          .join("");
      }

      function handleCardClick(employeeId) {
        const now = Date.now();
        const tapKey = `tap_${employeeId}`;

        if (lastTap[tapKey] && now - lastTap[tapKey] < 300) {
          toggleEmployee(employeeId);
          lastTap[tapKey] = 0;
        } else {
          lastTap[tapKey] = now;
        }
      }

      function toggleEmployee(employeeId) {
        const index = selectedEmployees.indexOf(employeeId);
        if (index > -1) {
          selectedEmployees.splice(index, 1);
        } else {
          selectedEmployees.push(employeeId);
        }
        updateUI();
      }

      function updateUI() {
        const searchBox = document.getElementById("searchBox");
        renderEmployees(searchBox ? searchBox.value : "");
        updateStats();
        updateActionBar();
      }

      function updateStats() {
        const totalEl = document.getElementById("totalEmployees");
        const selectedEl = document.getElementById("selectedCount");
        const matinEl = document.getElementById("matinCount");
        const soirEl = document.getElementById("soirCount");

        if (totalEl) totalEl.textContent = employees.length;
        if (selectedEl) selectedEl.textContent = selectedEmployees.length;
        if (matinEl) {
          matinEl.textContent = employees.filter(
            (e) => e.status === "matin" || e.status === "complet"
          ).length;
        }
        if (soirEl) {
          soirEl.textContent = employees.filter(
            (e) => e.status === "soir" || e.status === "complet"
          ).length;
        }
      }

      function updateActionBar() {
        const actionBar = document.getElementById("actionBar");
        const selectionText = document.getElementById("selectionText");

        if (selectedEmployees.length > 0 && currentPage === "pointage") {
          actionBar.classList.add("visible");
          selectionText.textContent = `${selectedEmployees.length} employ√©(s) s√©lectionn√©(s)`;
        } else {
          actionBar.classList.remove("visible");
        }
      }

      function validatePointage(type) {
        if (selectedEmployees.length === 0) return;

        currentPointageType = type;
        document.getElementById("modalEmployeeCount").textContent =
          selectedEmployees.length;
        document.getElementById("modalPointageType").textContent =
          type === "matin" ? "‚òÄÔ∏è Matin (0.5 jour)" : "üåô Soir (0.5 jour)";

        document.getElementById("modalOverlay").classList.add("visible");
      }

      function closeModal() {
        document.getElementById("modalOverlay").classList.remove("visible");
      }

      function confirmPointage() {
        selectedEmployees.forEach((empId) => {
          const employee = employees.find((e) => e.id === empId);
          if (employee) {
            if (currentPointageType === "matin") {
              if (employee.status === "non-pointe") {
                employee.status = "matin";
              } else if (employee.status === "soir") {
                employee.status = "complet";
              }
            } else if (currentPointageType === "soir") {
              if (employee.status === "non-pointe") {
                employee.status = "soir";
              } else if (employee.status === "matin") {
                employee.status = "complet";
              }
            }
          }
        });

        closeModal();
        showToast(
          `‚úì Pointage enregistr√© avec succ√®s pour ${selectedEmployees.length} employ√©(s)`
        );

        selectedEmployees = [];
        updateUI();
      }

      function showToast(message) {
        const toast = document.getElementById("toast");
        const toastMessage = document.getElementById("toastMessage");

        toastMessage.textContent = message;
        toast.classList.add("visible");

        if (navigator.vibrate) {
          navigator.vibrate(200);
        }

        setTimeout(() => {
          toast.classList.remove("visible");
        }, 3000);
      }

      function setupSearch() {
        const searchBox = document.getElementById("searchBox");
        if (searchBox) {
          searchBox.addEventListener("input", (e) => {
            renderEmployees(e.target.value);
          });
        }
      }

      function toggleFilter() {
        showToast(
          "Fonctionnalit√© de filtres √† venir : filtrer par √©quipe, m√©tier, statut, etc."
        );
      }

      // HISTORIQUE PAGE FUNCTIONS
      function renderHistory() {
        const historyList = document.getElementById("historyList");
        if (!historyList) return;

        historyList.innerHTML = historyData
          .map(
            (item) => `
          <div class="history-item">
            <div class="history-header">
              <div class="history-date">${new Date(
                item.date
              ).toLocaleDateString("fr-FR", {
                weekday: "long",
                year: "numeric",
                month: "long",
                day: "numeric",
              })}</div>
              <div class="history-stats">
                <div class="history-stat">
                  <div class="history-stat-value">${item.totalEmployes}</div>
                  <div class="history-stat-label">Total</div>
                </div>
                <div class="history-stat">
                  <div class="history-stat-value" style="color: #f39c12;">${
                    item.matin
                  }</div>
                  <div class="history-stat-label">Matin</div>
                </div>
                <div class="history-stat">
                  <div class="history-stat-value" style="color: #3498db;">${
                    item.soir
                  }</div>
                  <div class="history-stat-label">Soir</div>
                </div>
                <div class="history-stat">
                  <div class="history-stat-value" style="color: #e74c3c;">${
                    item.absents
                  }</div>
                  <div class="history-stat-label">Absents</div>
                </div>
              </div>
            </div>
            <div class="history-details">
              <div class="history-detail-item">
                <strong>Chantier:</strong> ${item.chantier}
              </div>
              <div class="history-detail-item">
                <strong>Taux pr√©sence:</strong> ${Math.round(
                  ((item.totalEmployes - item.absents) / item.totalEmployes) *
                    100
                )}%
              </div>
              <div class="history-detail-item">
                <strong>Jours travaill√©s:</strong> ${
                  (item.matin + item.soir) / 2
                } j
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function applyHistoryFilters() {
        showToast("Filtres appliqu√©s avec succ√®s!");
      }

      // SCANNER PAGE FUNCTIONS
      function startScanner() {
        showToast("üì∑ Cam√©ra activ√©e - Scannez le QR code");
        setTimeout(() => {
          // Simulation de scan
          const randomEmp =
            employees[Math.floor(Math.random() * employees.length)];
          showToast(
            `‚úì QR Code scann√©: ${randomEmp.name} (${randomEmp.matricule})`
          );
        }, 2000);
      }

      function validateManualEntry() {
        const matricule = document
          .getElementById("manualMatricule")
          .value.trim();
        if (!matricule) {
          showToast("‚ö†Ô∏è Veuillez entrer un matricule");
          return;
        }

        const employee = employees.find(
          (e) => e.matricule.toLowerCase() === matricule.toLowerCase()
        );
        if (employee) {
          showToast(`‚úì Pointage valid√© pour ${employee.name}`);
          document.getElementById("manualMatricule").value = "";
        } else {
          showToast("‚ùå Matricule non trouv√©");
        }
      }

      // CHANTIERS PAGE FUNCTIONS
      function renderChantiers() {
        const chantiersList = document.getElementById("chantiersList");
        if (!chantiersList) return;

        chantiersList.innerHTML = chantiers
          .map(
            (chantier) => `
          <div class="chantier-card" onclick="openChantier(${chantier.id})">
            <div class="chantier-header">
              <div>
                <div class="chantier-title">${chantier.nom}</div>
                <div class="chantier-info">${chantier.adresse}</div>
              </div>
              <div class="chantier-status status-${chantier.status}">
                ${
                  chantier.status === "actif"
                    ? "Actif"
                    : chantier.status === "pause"
                    ? "En pause"
                    : "Termin√©"
                }
              </div>
            </div>
            
            <div class="chantier-info-row">
              <span>üìÖ D√©but: ${new Date(chantier.dateDebut).toLocaleDateString(
                "fr-FR"
              )}</span>
            </div>
            <div class="chantier-info-row">
              <span>üë∑ ${chantier.employes} employ√©s</span>
              <span>üë®‚Äçüíº ${chantier.responsable}</span>
            </div>
            
            <div class="chantier-progress">
              <div class="progress-label">
                <span>Progression</span>
                <span><strong>${chantier.progression}%</strong></span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" style="width: ${
                  chantier.progression
                }%"></div>
              </div>
            </div>
            
            <div class="chantier-team">
              <span style="color: #7f8c8d; font-size: 14px;">√âquipe:</span>
              <div class="team-avatars">
                ${Array.from(
                  { length: Math.min(chantier.employes, 5) },
                  (_, i) => `
                  <div class="team-avatar">${String.fromCharCode(65 + i)}</div>
                `
                ).join("")}
                ${
                  chantier.employes > 5
                    ? `<div class="team-avatar">+${chantier.employes - 5}</div>`
                    : ""
                }
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function openChantier(id) {
        const chantier = chantiers.find((c) => c.id === id);
        if (chantier) {
          showToast(`üìã Ouverture du chantier: ${chantier.nom}`);
        }
      }

      function addChantier() {
        showToast("‚ûï Cr√©er un nouveau chantier");
      }

      // PLUS PAGE FUNCTIONS
      function renderPlusMenu() {
        const plusMenu = document.getElementById("plusMenu");
        if (!plusMenu) return;

        plusMenu.innerHTML = plusMenuItems
          .map(
            (item) => `
          <div class="menu-card" onclick="handleMenuAction('${item.action}')">
            <div class="menu-icon">${item.icon}</div>
            <div class="menu-title">${item.title}</div>
            <div class="menu-description">${item.description}</div>
          </div>
        `
          )
          .join("");
      }

      function handleMenuAction(action) {
        const messages = {
          equipes: "üë• Gestion des √©quipes de travail",
          rapports: "üìÑ G√©n√©ration de rapports d√©taill√©s",
          planning: "üìÖ Planification des horaires",
          paie: "üí∞ Calcul et gestion de la paie",
          profil: "üë§ Gestion de votre profil",
          parametres: "‚öôÔ∏è Configuration de l'application",
          notifications: "üì± Gestion des notifications",
          statistiques: "üìä Tableaux de bord et analyses",
          support: "üìû Contacter l'assistance technique",
        };

        showToast(messages[action] || "Fonctionnalit√© en d√©veloppement");
      }

      // INIT
      init();
    </script>
  </body>
</html>
